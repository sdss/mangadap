

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mangadap.dapfits module &mdash; mangadap 2.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mangadap 2.2.2 documentation" href="index.html"/>
        <link rel="up" title="mangadap package" href="mangadap.html"/>
        <link rel="next" title="mangadap.drpfits module" href="mangadap.drpfits.html"/>
        <link rel="prev" title="mangadap.util.version module" href="mangadap.util.version.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mangadap
          

          
          </a>

          
            
            
              <div class="version">
                2.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mangadap.html">mangadap package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#subpackages">Subpackages</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="mangadap.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">mangadap.dapfits module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.drpfits.html">mangadap.drpfits module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#module-mangadap">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mangadap</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="mangadap.html">mangadap package</a> &raquo;</li>
        
      <li>mangadap.dapfits module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mangadap.dapfits.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mangadap.dapfits">
<span id="mangadap-dapfits-module"></span><h1>mangadap.dapfits module<a class="headerlink" href="#module-mangadap.dapfits" title="Permalink to this headline">¶</a></h1>
<p>Defines a class used to interface with the final maps files produced by
the MaNGA Data Analysis Pipeline (DAP).</p>
<dl class="docutils">
<dt><em>License</em>:</dt>
<dd><dl class="first last docutils">
<dt>Copyright (c) 2015, SDSS-IV/MaNGA Pipeline Group</dt>
<dd>Licensed under BSD 3-clause license - see LICENSE.rst</dd>
</dl>
</dd>
<dt><em>Source location</em>:</dt>
<dd>$MANGADAP_DIR/python/mangadap/dapfits.py</dd>
<dt><em>Imports and python version compliance</em>:</dt>
<dd><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span> <span class="o">&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="n">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="k">import</span> <span class="n">WCS</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">astropy.constants</span>

<span class="kn">from</span> <span class="nn">.drpfits</span> <span class="k">import</span> <span class="n">DRPFits</span><span class="p">,</span> <span class="n">DRPQuality3DBitMask</span>
<span class="kn">from</span> <span class="nn">.util.fitsutil</span> <span class="k">import</span> <span class="n">DAPFitsUtil</span>
<span class="kn">from</span> <span class="nn">.util.bitmask</span> <span class="k">import</span> <span class="n">BitMask</span>
<span class="kn">from</span> <span class="nn">.util.log</span> <span class="k">import</span> <span class="n">log_output</span>
<span class="kn">from</span> <span class="nn">.util.fileio</span> <span class="k">import</span> <span class="n">channel_dictionary</span>
<span class="kn">from</span> <span class="nn">.util.exception_tools</span> <span class="k">import</span> <span class="n">print_frame</span>
<span class="kn">from</span> <span class="nn">.par.obsinput</span> <span class="k">import</span> <span class="n">ObsInputPar</span>
<span class="kn">from</span> <span class="nn">.config.defaults</span> <span class="k">import</span> <span class="n">default_drp_version</span><span class="p">,</span> <span class="n">default_dap_source</span><span class="p">,</span> <span class="n">default_dap_version</span>
<span class="kn">from</span> <span class="nn">.config.defaults</span> <span class="k">import</span> <span class="n">default_dap_par_file</span><span class="p">,</span> <span class="n">default_analysis_path</span>
<span class="kn">from</span> <span class="nn">.config.defaults</span> <span class="k">import</span> <span class="n">default_dap_method</span><span class="p">,</span> <span class="n">default_dap_method_path</span>
<span class="kn">from</span> <span class="nn">.config.defaults</span> <span class="k">import</span> <span class="n">default_dap_file_name</span>
<span class="kn">from</span> <span class="nn">.proc.reductionassessments</span> <span class="k">import</span> <span class="n">ReductionAssessment</span>
<span class="kn">from</span> <span class="nn">.proc.spatiallybinnedspectra</span> <span class="k">import</span> <span class="n">SpatiallyBinnedSpectra</span>
<span class="kn">from</span> <span class="nn">.proc.stellarcontinuummodel</span> <span class="k">import</span> <span class="n">StellarContinuumModel</span>
<span class="kn">from</span> <span class="nn">.proc.emissionlinemoments</span> <span class="k">import</span> <span class="n">EmissionLineMoments</span>
<span class="kn">from</span> <span class="nn">.proc.emissionlinemodel</span> <span class="k">import</span> <span class="n">EmissionLineModel</span>
<span class="kn">from</span> <span class="nn">.proc.spectralindices</span> <span class="k">import</span> <span class="n">SpectralIndices</span>
</pre></div>
</div>
</dd>
<dt><em>Class usage examples</em>:</dt>
<dd>Add some usage comments here!</dd>
<dt><em>Revision history</em>:</dt>
<dd><div class="first last line-block">
<div class="line"><strong>08 Jun 2016</strong>: Original Implementation by K. Westfall (KBW)</div>
<div class="line"><strong>25 Aug 2016</strong>: (KBW) Added <a class="reference internal" href="#mangadap.dapfits.DAPFits.unique_indices" title="mangadap.dapfits.DAPFits.unique_indices"><code class="xref py py-func docutils literal"><span class="pre">DAPFits.unique_indices()</span></code></a>,
<a class="reference internal" href="#mangadap.dapfits.DAPFits.unique_mask" title="mangadap.dapfits.DAPFits.unique_mask"><code class="xref py py-func docutils literal"><span class="pre">DAPFits.unique_mask()</span></code></a>, and <a class="reference internal" href="#mangadap.dapfits.DAPFits.channel_map" title="mangadap.dapfits.DAPFits.channel_map"><code class="xref py py-func docutils literal"><span class="pre">DAPFits.channel_map()</span></code></a></div>
<div class="line"><strong>Feb 2017</strong>: (KBW) Merged construct maps and cube functions here
and removed dapmaps.py and dapcube.py.</div>
<div class="line">** 3 May 2017**: (KBW) Allow output maps and cube types to be
single-precision (float32) floats, and changed BINID from int
(defaults to 64-bit) to int32.</div>
<div class="line"><strong>24 Aug 2017</strong>: (KBW) Added BADGEOM DAPQUAL bit; signifies
invalid photometric geometry parameters used when instantiating
the <a class="reference internal" href="mangadap.par.obsinput.html#mangadap.par.obsinput.ObsInputPar" title="mangadap.par.obsinput.ObsInputPar"><code class="xref py py-class docutils literal"><span class="pre">mangadap.par.obsinput.ObsInputPar</span></code></a> object.</div>
<div class="line"><strong>29 Aug 2017</strong>: (KBW) Add S/N metrics to the MAPS primary header</div>
<div class="line"><strong>30 Aug 2017</strong>: (KBW) Convert some changes from Xihan Ji.</div>
<div class="line"><strong>19 Mar 2018</strong>: (KBW) Mask spectral indices with incomplete band
coverage as unreliable.</div>
</div>
</dd>
</dl>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Allow DAPFits to read/access both the MAPS and the LOGCUBE files,
not just the former.</li>
</ul>
</div>
<dl class="class">
<dt id="mangadap.dapfits.DAPCubeBitMask">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">DAPCubeBitMask</code><span class="sig-paren">(</span><em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPCubeBitMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPCubeBitMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a></p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Force read IDLUTILS version as opposed to internal one?</li>
</ul>
</div>
</dd></dl>

<dl class="class">
<dt id="mangadap.dapfits.DAPFits">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">DAPFits</code><span class="sig-paren">(</span><em>plate</em>, <em>ifudesign</em>, <em>method</em>, <em>drpver=None</em>, <em>dapver=None</em>, <em>analysis_path=None</em>, <em>directory_path=None</em>, <em>reference_path=None</em>, <em>par_file=None</em>, <em>read=True</em>, <em>checksum=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Object used to hold properties of and read data from a DAP-produced file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>plate</strong> (<em>int</em>) – Plate number</li>
<li><strong>ifudesign</strong> (<em>int</em>) – IFU design</li>
<li><strong>method</strong> (<em>str</em>) – Method type (e.g., <code class="docutils literal"><span class="pre">'SPX-GAU-MILESTHIN'</span></code>)</li>
<li><strong>drpver</strong> (<em>str</em>) – (<strong>Optional</strong>) DRP version, which is used to
define the default DAP analysis path.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_drp_version" title="mangadap.config.defaults.default_drp_version"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_drp_version()</span></code></a></li>
<li><strong>dapver</strong> (<em>str</em>) – (<strong>Optional</strong>) DAP version, which is used to define
the default DAP analysis path.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_version" title="mangadap.config.defaults.default_dap_version"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_dap_version()</span></code></a></li>
<li><strong>analysis_path</strong> (<em>str</em>) – (<strong>Optional</strong>) The path to the top level
directory containing the DAP output files for a given DRP
and DAP version.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_analysis_path" title="mangadap.config.defaults.default_analysis_path"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_analysis_path()</span></code></a>.</li>
<li><strong>directory_path</strong> (<em>str</em>) – (<strong>Optional</strong>) The exact path to the DAP
file.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_method_path" title="mangadap.config.defaults.default_dap_method_path"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_dap_method_path()</span></code></a>.</li>
<li><strong>reference_path</strong> (<em>str</em>) – (<strong>Optional</strong>) The exact path of the DAP
reference directory.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_method_path" title="mangadap.config.defaults.default_dap_method_path"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_dap_method_path()</span></code></a>.</li>
<li><strong>par_file</strong> (<em>str</em>) – (<strong>Optional</strong>) SDSS parameter file used to
provide input parameters for the DAP.  Default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_par_file" title="mangadap.config.defaults.default_dap_par_file"><code class="xref py py-func docutils literal"><span class="pre">mangadap.config.defaults.default_dap_par_file()</span></code></a>.</li>
<li><strong>read</strong> (<em>bool</em>) – (<strong>Optional</strong>) Read the DAP file upon
instantiation of the object.</li>
<li><strong>checksum</strong> (<em>bool</em>) – (<strong>Optional</strong>) Flag for <a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/api/files.html#astropy.io.fits.open">astropy.io.fits.open</a>
checksum operation.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.plate">
<code class="descname">plate</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.plate" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – Plate number</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.ifudesign">
<code class="descname">ifudesign</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.ifudesign" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – IFU design</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.method">
<code class="descname">method</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.method" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Method type</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.drpver">
<code class="descname">drpver</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.drpver" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – DRP version</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.dapver">
<code class="descname">dapver</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.dapver" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – DAP version</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.analysis_path">
<code class="descname">analysis_path</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.analysis_path" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The path to the top level
directory containing the DAP output files for a given DRP
and DAP version.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.directory_path">
<code class="descname">directory_path</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.directory_path" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The exact path to the DAP file.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.reference_path">
<code class="descname">reference_path</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.reference_path" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The exact path of the DAP reference directory.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.par_file">
<code class="descname">par_file</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.par_file" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – SDSS parameter file used to provide input
parameters for the DAP.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.dapqual">
<code class="descname">dapqual</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.dapqual" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">mangadap.dapmaps.DAPQualityBitMask</span></code> – Global
quality bit</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.bitmask">
<code class="descname">bitmask</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.bitmask" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">mangadap.dapmaps.DAPMapsBitMask</span></code> – Map mask
bits</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.hdu">
<code class="descname">hdu</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.hdu" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://docs.astropy.org/en/v1.0.2/io/fits/api/hdulists.html">astropy.io.fits.hdu.hdulist.HDUList</a> – HDUList read from
the DRP file</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.par">
<code class="descname">par</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.par" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="xref py py-class docutils literal"><span class="pre">mangadap.par.ObsInputPar</span></code> – List of parameters used
by the DAP.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.dapfits.DAPFits.checksum">
<code class="descname">checksum</code><a class="headerlink" href="#mangadap.dapfits.DAPFits.checksum" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> – Boolean to use for checksum in
<a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/api/files.html#astropy.io.fits.open">astropy.io.fits.open</a>.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.channel_map">
<code class="descname">channel_map</code><span class="sig-paren">(</span><em>ext</em>, <em>channel=None</em>, <em>flag=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.channel_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.channel_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2D array with the map for the specified channel.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.effective_radius">
<code class="descname">effective_radius</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.effective_radius"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.effective_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the effective radius from the parameter file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.file_name">
<code class="descname">file_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.file_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the DAP file</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.file_path">
<code class="descname">file_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.file_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.file_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full path to the DAP file</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.guess_cz">
<code class="descname">guess_cz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.guess_cz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.guess_cz" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the guess redshift (cz) from the parameter file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.guess_inclination">
<code class="descname">guess_inclination</code><span class="sig-paren">(</span><em>q0=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.guess_inclination"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.guess_inclination" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a guess inclination based on the isophotal ellipticity
from the input parameter file using the equation:</p>
<div class="math">
\[\cos^2 i = \frac{ q^2 - q_0^2 }{ 1 - q_0^2 },\]</div>
<p>where <span class="math">\(q\)</span> is the observed oblateness (the semi-minor to
semi-major axis ratio, <span class="math">\(q = 1-\epsilon = b/a\)</span>) and
<span class="math">\(q_0\)</span> is the intrinsic oblateness.</p>
<p>If <span class="math">\(q &lt; q_0\)</span>, the function returns a 90 degree
inclination.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>q0</strong> (<em>float</em>) – (<strong>Optional</strong>) The intrinsic oblateness of the
system.  If not provided, the system is assumed to be
infinitely thin.</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">Exception</span></code> – Raised if the input intrinsic oblatenss is not
less than one and greater than 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.guess_position_angle">
<code class="descname">guess_position_angle</code><span class="sig-paren">(</span><em>flip=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.guess_position_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.guess_position_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the guess position angle from the parameter file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flip</strong> (<em>bool</em>) – (<strong>Optional</strong>) Offset the provided position
angle by 180 deg.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.list_channels">
<code class="descname">list_channels</code><span class="sig-paren">(</span><em>ext</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.list_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.list_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a list of the channels in a given extension.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.open_hdu">
<code class="descname">open_hdu</code><span class="sig-paren">(</span><em>permissions='readonly'</em>, <em>checksum=False</em>, <em>quiet=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.open_hdu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.open_hdu" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the fits file and save it to <a class="reference internal" href="#mangadap.dapfits.DAPFits.hdu" title="mangadap.dapfits.DAPFits.hdu"><code class="xref py py-attr docutils literal"><span class="pre">hdu</span></code></a>; if <a class="reference internal" href="#mangadap.dapfits.DAPFits.hdu" title="mangadap.dapfits.DAPFits.hdu"><code class="xref py py-attr docutils literal"><span class="pre">hdu</span></code></a> is
not None, the function returns without re-reading the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>permissions</strong> (<em>string</em>) – (<strong>Optional</strong>) Open the fits file with
these read/write permissions.</li>
<li><strong>checksum</strong> (<em>bool</em>) – (<strong>Optional</strong>) Flag for
<a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/api/files.html#astropy.io.fits.open">astropy.io.fits.open</a> checksum operation.  This
overrides the internal <a class="reference internal" href="#mangadap.dapfits.DAPFits.checksum" title="mangadap.dapfits.DAPFits.checksum"><code class="xref py py-attr docutils literal"><span class="pre">checksum</span></code></a> attribute <strong>for
the current operation only</strong>.</li>
<li><strong>quiet</strong> (<em>bool</em>) – (<strong>Optional</strong>) Suppress terminal output</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">FileNotFoundError</span></code> – Raised if the DAP file doesn’t exist.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.read_par">
<code class="descname">read_par</code><span class="sig-paren">(</span><em>quiet=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.read_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.read_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the parameter file and save it to <a class="reference internal" href="#mangadap.dapfits.DAPFits.par" title="mangadap.dapfits.DAPFits.par"><code class="xref py py-attr docutils literal"><span class="pre">par</span></code></a>; if
<a class="reference internal" href="#mangadap.dapfits.DAPFits.par" title="mangadap.dapfits.DAPFits.par"><code class="xref py py-attr docutils literal"><span class="pre">par</span></code></a> is not None, the function returns without re-reading
the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>quiet</strong> (<em>bool</em>) – Suppress terminal output</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.thin_disk_polar_coo">
<code class="descname">thin_disk_polar_coo</code><span class="sig-paren">(</span><em>xc=None</em>, <em>yc=None</em>, <em>rot=None</em>, <em>pa=None</em>, <em>inc=None</em>, <em>flip=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.thin_disk_polar_coo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.thin_disk_polar_coo" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the disk-plane coordinates for all the binned spectra
using <a class="reference internal" href="mangadap.util.geometry.html#mangadap.util.geometry.SemiMajorAxisCoo" title="mangadap.util.geometry.SemiMajorAxisCoo"><code class="xref py py-class docutils literal"><span class="pre">mangadap.util.geometry.SemiMajorAxisCoo</span></code></a>.  See the
documentation their for further information regarding the
calculations.</p>
<p>If not provided, the default position angle and inclination will
be taken from the input parameter file, if available.  If the
parameter file cannot be read, the default values for the
position angle and ellipticity in
<a class="reference internal" href="mangadap.util.geometry.html#mangadap.util.geometry.SemiMajorAxisCoo" title="mangadap.util.geometry.SemiMajorAxisCoo"><code class="xref py py-class docutils literal"><span class="pre">mangadap.util.geometry.SemiMajorAxisCoo</span></code></a> are used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xc</strong><strong>,</strong><strong>yc</strong> (<em>float</em><em>,</em><em>float</em>) – (<strong>Optional</strong>) a reference on-sky
position relative to the center of the projected plane
(galaxy center).</li>
<li><strong>rot</strong> (<em>float</em>) – (<strong>Optional</strong>) Cartesian rotation of the
focal-plane relative to the sky-plane (+x toward East;
+y toward North).</li>
<li><strong>pa</strong> (<em>float</em>) – (<strong>Optional</strong>) On-sky position angle of the
major axis of the ellipse traced on the sky by a circle
in the projected plane, defined as the angle from North
through East.</li>
<li><strong>inc</strong> (<em>float</em>) – (<strong>Optional</strong>) Inclination of the plane, angle
between the disk normal and the normal of the sky plane
(inc=0 is a face-on plane).</li>
<li><strong>flip</strong> (<em>bool</em>) – (<strong>Optional</strong>) Offset the provided position
angle by 180 deg; e.g., to set the position angle will
be defined along the receding major axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Two numpy arrays with the projected polar</dt>
<dd><p class="first last">coordinates: <span class="math">\(R, \theta\)</span>.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.unique_indices">
<code class="descname">unique_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.unique_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.unique_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the BINID extension to select the spaxels with unique data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Returns the list of indices <strong>in the
flattened array of a map</strong> that are unique.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.DAPFits.unique_mask">
<code class="descname">unique_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPFits.unique_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPFits.unique_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a boolean mask for the unique bins.</p>
<p>The returned map is True for spaxels that are part of a unique
bin, Fals otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mangadap.dapfits.DAPMapsBitMask">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">DAPMapsBitMask</code><span class="sig-paren">(</span><em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPMapsBitMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPMapsBitMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a></p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Force read IDLUTILS version as opposed to internal one?</li>
</ul>
</div>
</dd></dl>

<dl class="class">
<dt id="mangadap.dapfits.DAPQualityBitMask">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">DAPQualityBitMask</code><span class="sig-paren">(</span><em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#DAPQualityBitMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.DAPQualityBitMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a></p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Force read IDLUTILS version as opposed to internal one?</li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="mangadap.dapfits.add_snr_metrics_to_header">
<code class="descclassname">mangadap.dapfits.</code><code class="descname">add_snr_metrics_to_header</code><span class="sig-paren">(</span><em>hdr</em>, <em>drpf</em>, <em>r_re</em>, <em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#add_snr_metrics_to_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.add_snr_metrics_to_header" title="Permalink to this definition">¶</a></dt>
<dd><p>For all valid spaxels within 1 Re &lt; R &lt; 1.5 Re calculate the median
S/N and combined S/N (including covariance) in the griz bands.</p>
<dl class="docutils">
<dt>Adds the following keywords (8) to the header:</dt>
<dd><ul class="first last simple">
<li>SNR?MED: Median S/N within 1-1.5 Re in each of the griz bands.</li>
<li>SNR?RING: The combined S/N of all spaxels within 1-1.5 Re in
the griz bands, incuding covariance</li>
</ul>
</dd>
</dl>
<p>The inclusion of covariance is based on the exact calculation of the
correlation matrix at the flux-weighted center of each band, and
assuming no change in the correlation between the response-weighted
correlation within the broad band.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hdr</strong> (<a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/api/headers.html">astropy.io.fits.Header</a>) – Header object to edit</li>
<li><strong>drpf</strong> (<a class="reference internal" href="mangadap.drpfits.html#mangadap.drpfits.DRPFits" title="mangadap.drpfits.DRPFits"><code class="xref py py-class docutils literal"><span class="pre">mangadap.drpfits.DRPFits</span></code></a>) – DRP fits cube</li>
<li><strong>r_re</strong> (<em>numpy.ndarray</em>) – <em>Flattened</em> array with the semi-major axis
radius in units of the effective radius for all spaxels in
the datacube.  Shape should be (Nx*Ny,), where the shape of
the datacube is (Nx,Ny,Nwave).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The edited header object.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="http://docs.astropy.org/en/stable/io/fits/api/headers.html">astropy.io.fits.Header</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">FileNotFoundError</span></code> – Raised if any of the response function files
cannot be found.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mangadap.dapfits.combine_binid_extensions">
<code class="descclassname">mangadap.dapfits.</code><code class="descname">combine_binid_extensions</code><span class="sig-paren">(</span><em>drpf</em>, <em>binned_spectra</em>, <em>stellar_continuum</em>, <em>emission_line_moments</em>, <em>emission_line_model</em>, <em>spectral_indices</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#combine_binid_extensions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.combine_binid_extensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the bin IDs from the different analysis steps into a single
multichannel extension.</p>
</dd></dl>

<dl class="function">
<dt id="mangadap.dapfits.confirm_dap_types">
<code class="descclassname">mangadap.dapfits.</code><code class="descname">confirm_dap_types</code><span class="sig-paren">(</span><em>drpf</em>, <em>obs</em>, <em>rdxqa</em>, <em>binned_spectra</em>, <em>stellar_continuum</em>, <em>emission_line_moments</em>, <em>emission_line_model</em>, <em>spectral_indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#confirm_dap_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.confirm_dap_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="mangadap.dapfits.construct_cube_file">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">construct_cube_file</code><span class="sig-paren">(</span><em>drpf</em>, <em>obs=None</em>, <em>binned_spectra=None</em>, <em>stellar_continuum=None</em>, <em>emission_line_model=None</em>, <em>dapsrc=None</em>, <em>dapver=None</em>, <em>analysis_path=None</em>, <em>directory_path=None</em>, <em>output_file=None</em>, <em>clobber=True</em>, <em>loggers=None</em>, <em>quiet=False</em>, <em>single_precision=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Construct a DAP cube file based on the input data.</p>
<p>Set as a class for coherency reasons, but should not be used as an
object!</p>
<p>Should force all intermediate objects to be provided.</p>
<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file._assign_cube_arrays">
<code class="descname">_assign_cube_arrays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file._assign_cube_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file._assign_cube_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="xref py py-attr docutils literal"><span class="pre">cube_arrays</span></code>, which contains the list of extensions in
<code class="xref py py-attr docutils literal"><span class="pre">hdu</span></code> that contain spectral data.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file._get_emission_line_model_mask">
<code class="descname">_get_emission_line_model_mask</code><span class="sig-paren">(</span><em>emission_line_model</em>, <em>emission_line_model_3d_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file._get_emission_line_model_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file._get_emission_line_model_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>From the emission-line model object:</dt>
<dd><ul class="first last simple">
<li>copy ARTIFACT</li>
<li>consolidate DIDNOTUSE, LOW_SNR, OUTSIDE_RANGE into IGNORED_EL</li>
<li>copy FIT_FAILED, NEAR_BOUND into ELFAILED</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file._get_model_and_data_mask">
<code class="descname">_get_model_and_data_mask</code><span class="sig-paren">(</span><em>binned_spectra</em>, <em>binned_spectra_3d_hdu</em>, <em>stellar_continuum</em>, <em>stellar_continuum_3d_hdu</em>, <em>emission_line_model</em>, <em>emission_line_model_3d_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file._get_model_and_data_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file._get_model_and_data_mask" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>For the binned spectra:</dt>
<dd><ul class="first last simple">
<li>consolidate DIDNOTUSE, LOW_SPECCOV, LOW_SNR from
binned_spectra into IGNORED</li>
<li>consolidate NONE_IN_STACK from binned_spectra into
FLUXINVALID</li>
</ul>
</dd>
<dt>For the model spectra:</dt>
<dd><ul class="first last simple">
<li>copy INVALID_ERROR from stellar_continuum into
IVARINVALID</li>
<li>copy ARTIFACTs from both stellar_continuum and
emission_line_model</li>
<li>from stellar_continuum, consolidate DIDNOTUSE, LOW_SNR,
OUTSIDE_RANGE, EML_REGION, TPL_PIXELS, TRUNCATED,
PPXF_REJECT, INVALID_ERROR into a list of pixels ignored
by the stellar-continuum fit</li>
<li>from emission_line_model, consolidate DIDNOTUSE, LOW_SNR,
OUTSIDE_RANGE into a list of pixels ignored by the
emission-line fit</li>
<li>flag pixels as FITIGNORED if the pixel is ignored by
<strong>both</strong> the stellar-continuum and emission-line fits</li>
<li>from stellar_continuum, consolidate FIT_FAILED and
NEAR_BOUND into a list of failed pixels from the
stellar-continuum fit</li>
<li>do the same for the emission-line fitting mask</li>
<li>flag pixels as FIT_FAILED if the pixel failed in
<strong>either</strong> the stellar-continuum or emission-line fits</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file._initialize_mask">
<code class="descname">_initialize_mask</code><span class="sig-paren">(</span><em>binned_spectra</em>, <em>binned_spectra_3d_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file._initialize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file._initialize_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the mask based on the DRP cube mask.</p>
<p>IVAR_INVALID:  Test of invalid inverse variance based on the DRP
file.  THIS SHOULD BE A TEST THAT IS INCLUDED IN THE
BINNED_SPECTRA OBJECT.  This should match the flags from the
stellar continuum model object.</p>
<p>Copy the FORESTAR flags from the DRP file to the this one</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file._set_paths">
<code class="descname">_set_paths</code><span class="sig-paren">(</span><em>directory_path</em>, <em>dapver</em>, <em>analysis_path</em>, <em>output_file</em>, <em>binned_spectra</em>, <em>stellar_continuum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file._set_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file._set_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the paths relevant to the map file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file.emission_line_model_cube">
<code class="descname">emission_line_model_cube</code><span class="sig-paren">(</span><em>prihdr</em>, <em>binned_spectra</em>, <em>emission_line_model</em>, <em>emission_line_model_3d_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file.emission_line_model_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file.emission_line_model_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the ‘EMLINE’, ‘EMLINE_BASE’, and ‘EMLINE_MASK’ model
cube extensions.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_cube_file.model_and_data_cube">
<code class="descname">model_and_data_cube</code><span class="sig-paren">(</span><em>prihdr</em>, <em>binned_spectra</em>, <em>binned_spectra_3d_hdu</em>, <em>stellar_continuum</em>, <em>stellar_continuum_3d_hdu</em>, <em>emission_line_model</em>, <em>emission_line_model_3d_hdu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_cube_file.model_and_data_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_cube_file.model_and_data_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the ‘FLUX’, ‘IVAR’, ‘MASK’, ‘WAVE’, ‘REDCORR’, and
‘MODEL’ model cube extensions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mangadap.dapfits.construct_maps_file">
<em class="property">class </em><code class="descclassname">mangadap.dapfits.</code><code class="descname">construct_maps_file</code><span class="sig-paren">(</span><em>drpf</em>, <em>obs=None</em>, <em>rdxqa=None</em>, <em>binned_spectra=None</em>, <em>stellar_continuum=None</em>, <em>emission_line_moments=None</em>, <em>emission_line_model=None</em>, <em>spectral_indices=None</em>, <em>nsa_redshift=None</em>, <em>dapsrc=None</em>, <em>dapver=None</em>, <em>analysis_path=None</em>, <em>directory_path=None</em>, <em>output_file=None</em>, <em>clobber=True</em>, <em>loggers=None</em>, <em>quiet=False</em>, <em>single_precision=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Construct a DAP MAPS file.</p>
<p>Set as a class for coherency reasons, but should not be used as an
object!</p>
<p>Should force all intermediate objects to be provided.</p>
<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._build_binning_mask">
<code class="descname">_build_binning_mask</code><span class="sig-paren">(</span><em>binned_spectra</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._build_binning_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._build_binning_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._consolidate_donotuse">
<code class="descname">_consolidate_donotuse</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._consolidate_donotuse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._consolidate_donotuse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._emission_line_model_mask_to_map_mask">
<code class="descname">_emission_line_model_mask_to_map_mask</code><span class="sig-paren">(</span><em>emission_line_model</em>, <em>elf_mask</em>, <em>for_dispersion=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._emission_line_model_mask_to_map_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._emission_line_model_mask_to_map_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate and consolidate the emission-line moment masks to the map
pixel mask.</p>
<p>INSUFFICIENT_DATA propagated to NOVALUE</p>
<p>FIT_FAILED, UNDEFINED_COVAR propagated to FITFAILED</p>
<p>NEAR_BOUND copied to NEARBOUND</p>
<p>UNDEFINED_SIGMA propagated to UNRELIABLE</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._emission_line_moment_mask_to_map_mask">
<code class="descname">_emission_line_moment_mask_to_map_mask</code><span class="sig-paren">(</span><em>emission_line_moments</em>, <em>elm_mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._emission_line_moment_mask_to_map_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._emission_line_moment_mask_to_map_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate and consolidate the emission-line moment masks to the map
pixel mask.</p>
<p>DIDNOTUSE, FORESTAR propagated from already existing mask (self.bin_mask)</p>
<p>MAIN_EMPTY, BLUE_EMPTY, RED_EMPTY, UNDEFINED_BANDS propagated to NOVALUE</p>
<p>MAIN_JUMP, BLUE_JUMP, RED_JUMP, JUMP_BTWN_SIDEBANDS propagated to FITFAILED</p>
<p>MAIN_INCOMP, BLUE_INCOMP, RED_INCOMP propagated to UNRELIABLE</p>
<p>NO_ABSORPTION_CORRECTION propaged to NOCORRECTION</p>
<p>DIVBYZERO propagated to MATHERROR</p>
<p>Second moments not provided so no need to include UNDEFINED_MOM2</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._set_paths">
<code class="descname">_set_paths</code><span class="sig-paren">(</span><em>directory_path</em>, <em>dapver</em>, <em>analysis_path</em>, <em>output_file</em>, <em>binned_spectra</em>, <em>stellar_continuum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._set_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._set_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the paths relevant to the map file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._spectral_index_mask_to_map_mask">
<code class="descname">_spectral_index_mask_to_map_mask</code><span class="sig-paren">(</span><em>spectral_indices</em>, <em>si_mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._spectral_index_mask_to_map_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._spectral_index_mask_to_map_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Propagate and consolidate the spectral index masks to the map
pixel mask.</p>
<p>DIDNOTUSE, FORESTAR propagated from already existing mask (self.bin_mask)</p>
<p>MAIN_EMPTY, BLUE_EMPTY, RED_EMPTY, UNDEFINED_BANDS propagated to NOVALUE</p>
<p>MAIN_INCOMP, BLUE_INCOMP, RED_INCOMP propagated to UNRELIABLE</p>
<p>NO_DISPERSION_CORRECTION propagated to NOCORRECTION</p>
<p>DIVBYZERO propagated to MATHERROR</p>
<p>Need to further assess *_INCOMP to see if these lead to bad values (BADVALUE).</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file._stellar_continuum_mask_to_map_mask">
<code class="descname">_stellar_continuum_mask_to_map_mask</code><span class="sig-paren">(</span><em>stellar_continuum</em>, <em>sc_mask</em>, <em>for_dispersion=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file._stellar_continuum_mask_to_map_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file._stellar_continuum_mask_to_map_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>sc_mask constains the reconstructed map of the masks in each
stellar continuum fit (using the stellar continuum bitmask).</p>
<p>Propagate and consolidate the stellar-continuum masks to the map
pixel mask.</p>
<dl class="docutils">
<dt>DIDNOTUSE, FORESTAR propagated from already existing mask</dt>
<dd>(self.bin_mask)</dd>
</dl>
<p>LOW_SNR, NO_FIT, INSUFFICIENT_DATA propagated to NOVALUE</p>
<p>FIT_FAILED, NEAR_BOUND propagated to FITFAILED and NEARBOUND</p>
<dl class="docutils">
<dt>NEGATIVE_WEIGHTS consolidated into UNRELIABLE; if</dt>
<dd>dispersion=True, include BAD_SIGMA in this</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.binned_spectra_maps">
<code class="descname">binned_spectra_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>obs</em>, <em>binned_spectra</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.binned_spectra_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.binned_spectra_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the ‘BIN_LWSKYCOO’, ‘BIN_LWELLCOO’, ‘BIN_AREA’,
‘BIN_FAREA’, ‘BIN_MFLUX’, ‘BIN_MFLUX_IVAR’, ‘BIN_MFLUX_MASK’,
and ‘BIN_SNR’ map extensions.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.emission_line_model_maps">
<code class="descname">emission_line_model_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>emission_line_model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.emission_line_model_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.emission_line_model_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the ‘EMLINE_GFLUX’, ‘EMLINE_GFLUX_IVAR’,
‘EMLINE_GFLUX_MASK’, ‘EMLINE_GEW’, ‘EMLINE_GEW_IVAR’,
‘EMLINE_GEW_MASK’, ‘EMLINE_GVEL’, ‘EMLINE_GVEL_IVAR’,
‘EMLINE_GVEL_MASK’, ‘EMLINE_GSIGMA’, ‘EMLINE_GSIGMA_IVAR’,
‘EMLINE_GSIGMA_MASK’, ‘EMLINE_INSTSIGMA’, ‘EMLINE_TPLSIGMA’ map extensions.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.emission_line_moment_maps">
<code class="descname">emission_line_moment_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>emission_line_moments</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.emission_line_moment_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.emission_line_moment_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the ‘EMLINE_SFLUX’, ‘EMLINE_SFLUX_IVAR’,
‘EMLINE_SFLUX_MASK’, ‘EMLINE_SEW’, ‘EMLINE_SEW_IVAR’, and
‘EMLINE_SEW_MASK’ maps extensions.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.reduction_assessment_maps">
<code class="descname">reduction_assessment_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>obs</em>, <em>rdxqa</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.reduction_assessment_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.reduction_assessment_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the ‘SPX_SKYCOO’, ‘SPX_ELLCOO’, ‘SPX_MFLUX’,
‘SPX_MFLUX_IVAR’, and ‘SPX_SNR’ map extensions.</p>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">Add the spaxel correlation data.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.spectral_index_maps">
<code class="descname">spectral_index_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>spectral_indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.spectral_index_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.spectral_index_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the ‘SPECINDEX’, ‘SPECINDEX_IVAR’, ‘SPECINDEX_MASK’,
and ‘SPECINDEX_CORR’.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.dapfits.construct_maps_file.stellar_continuum_maps">
<code class="descname">stellar_continuum_maps</code><span class="sig-paren">(</span><em>prihdr</em>, <em>stellar_continuum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#construct_maps_file.stellar_continuum_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.construct_maps_file.stellar_continuum_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the ‘STELLAR_VEL’, ‘STELLAR_VEL_IVAR’,
‘STELLAR_VEL_MASK’, ‘STELLAR_SIGMA’, ‘STELLAR_SIGMA_IVAR’,
‘STELLAR_SIGMA_MASK’, ‘STELLAR_SIGMACORR’,
‘STELLAR_CONT_FRESID’, and ‘STELLAR_CONT_RCHI2’ maps extensions.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mangadap.dapfits.finalize_dap_primary_header">
<code class="descclassname">mangadap.dapfits.</code><code class="descname">finalize_dap_primary_header</code><span class="sig-paren">(</span><em>prihdr</em>, <em>drpf</em>, <em>obs</em>, <em>binned_spectra</em>, <em>stellar_continuum</em>, <em>dapsrc=None</em>, <em>loggers=None</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/dapfits.html#finalize_dap_primary_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.dapfits.finalize_dap_primary_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mangadap.drpfits.html" class="btn btn-neutral float-right" title="mangadap.drpfits module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mangadap.util.version.html" class="btn btn-neutral" title="mangadap.util.version module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SDSS-IV/MaNGA Pipeline Group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>