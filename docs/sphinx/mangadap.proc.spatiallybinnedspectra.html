

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mangadap.proc.spatiallybinnedspectra module &mdash; mangadap 2.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mangadap 2.2.2 documentation" href="index.html"/>
        <link rel="up" title="mangadap.proc package" href="mangadap.proc.html"/>
        <link rel="next" title="mangadap.proc.spectralfitting module" href="mangadap.proc.spectralfitting.html"/>
        <link rel="prev" title="mangadap.proc.spatialbinning module" href="mangadap.proc.spatialbinning.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mangadap
          

          
          </a>

          
            
            
              <div class="version">
                2.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="mangadap.html">mangadap package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="mangadap.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mangadap.config.html">mangadap.config package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.contrib.html">mangadap.contrib package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.par.html">mangadap.par package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="mangadap.proc.html">mangadap.proc package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="mangadap.proc.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="mangadap.proc.html#module-mangadap.proc">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.survey.html">mangadap.survey package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.tests.html">mangadap.tests package</a></li>
<li class="toctree-l3"><a class="reference internal" href="mangadap.util.html">mangadap.util package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mangadap.html#module-mangadap">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mangadap</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="mangadap.html">mangadap package</a> &raquo;</li>
        
          <li><a href="mangadap.proc.html">mangadap.proc package</a> &raquo;</li>
        
      <li>mangadap.proc.spatiallybinnedspectra module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mangadap.proc.spatiallybinnedspectra.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mangadap.proc.spatiallybinnedspectra">
<span id="mangadap-proc-spatiallybinnedspectra-module"></span><h1>mangadap.proc.spatiallybinnedspectra module<a class="headerlink" href="#module-mangadap.proc.spatiallybinnedspectra" title="Permalink to this headline">¶</a></h1>
<p>A class hierarchy that perform that spatially bins a set of
two-dimensional data.</p>
<p>The base class allows for user-defined definitions of binning
procedures.</p>
<dl class="docutils">
<dt><em>License</em>:</dt>
<dd><dl class="first last docutils">
<dt>Copyright (c) 2015, SDSS-IV/MaNGA Pipeline Group</dt>
<dd>Licensed under BSD 3-clause license - see LICENSE.rst</dd>
</dl>
</dd>
<dt><em>Source location</em>:</dt>
<dd>$MANGADAP_DIR/python/mangadap/proc/spatiallybinnedspectra.py</dd>
<dt><em>Imports and python version compliance</em>:</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span> <span class="o">&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
    <span class="n">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="k">import</span> <span class="n">remove</span><span class="p">,</span> <span class="n">environ</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="k">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="kn">from</span> <span class="nn">..par.parset</span> <span class="k">import</span> <span class="n">ParSet</span>
<span class="kn">from</span> <span class="nn">..config.defaults</span> <span class="k">import</span> <span class="n">dap_source_dir</span><span class="p">,</span> <span class="n">default_dap_common_path</span>
<span class="kn">from</span> <span class="nn">..config.defaults</span> <span class="k">import</span> <span class="n">default_dap_file_name</span>
<span class="kn">from</span> <span class="nn">..util.geometry</span> <span class="k">import</span> <span class="n">SemiMajorAxisCoo</span>
<span class="kn">from</span> <span class="nn">..util.fileio</span> <span class="k">import</span> <span class="n">init_record_array</span>
<span class="kn">from</span> <span class="nn">..util.parser</span> <span class="k">import</span> <span class="n">DefaultConfig</span>
<span class="kn">from</span> <span class="nn">..drpfits</span> <span class="k">import</span> <span class="n">DRPFits</span>
</pre></div>
</div>
</dd>
</dl>
<p><em>Class usage examples</em>:</p>
<blockquote>
<div><div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Add examples</p>
</div>
</div></blockquote>
<dl class="docutils">
<dt><em>Revision history</em>:</dt>
<dd><div class="first last line-block">
<div class="line"><strong>01 Apr 2016</strong>: Implementation begun by K. Westfall (KBW)</div>
<div class="line"><strong>19 May 2016</strong>: (KBW) Include SPECRES and SPECRESD extensions
from DRP file in output. Added loggers and quiet keyword
arguments to <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatiallyBinnedSpectra</span></code></a>, removed verbose</div>
<div class="line"><strong>06 Jul 2016</strong>: (KBW) Make the application of a reddening
correction an input parameter.</div>
<div class="line"><strong>25 Aug 2016</strong>: (KBW) Fixed error in bin area when calling
<code class="xref py py-func docutils literal notranslate"><span class="pre">SpatiallyBinnedSpetra._unbinned_data_table()</span></code></div>
<div class="line"><strong>01 Dec 2016</strong>: (KBW) Include keyword that describes how to
handle the spectral resolution.</div>
<div class="line"><strong>02 Dec 2016</strong>: (KBW) Incorporate
<a class="reference internal" href="mangadap.util.extinction.html#mangadap.util.extinction.GalacticExtinction" title="mangadap.util.extinction.GalacticExtinction"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.extinction.GalacticExtinction</span></code></a>.  Revert
main file structure to be bin-based instead of cube-based;
include convenience functions that construct the cube for each
extension as requested.</div>
<div class="line"><strong>06 Dec 2016</strong>: (KBW) Significantly restructured.</div>
<div class="line"><strong>23 Feb 2017</strong>: (KBW) Use DAPFitsUtil read and write functions.</div>
<div class="line"><strong>21 Aug 2017</strong>: (KBW) Use the new PRE-pixelized assessments of
the LSF.</div>
</div>
</dd>
</dl>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Check binning an RSS file</li>
</ul>
</div>
<dl class="class">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra">
<em class="property">class </em><code class="descclassname">mangadap.proc.spatiallybinnedspectra.</code><code class="descname">SpatiallyBinnedSpectra</code><span class="sig-paren">(</span><em>method_key</em>, <em>drpf</em>, <em>rdxqa</em>, <em>reff=None</em>, <em>method_list=None</em>, <em>dapsrc=None</em>, <em>dapver=None</em>, <em>analysis_path=None</em>, <em>directory_path=None</em>, <em>output_file=None</em>, <em>hardcopy=True</em>, <em>symlink_dir=None</em>, <em>clobber=False</em>, <em>checksum=False</em>, <em>loggers=None</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that holds spatially binned spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>method_key</strong> (<em>str</em>) – The keyword that designates which method,
provided in <em>method_list</em>, to use for the binning procedure.</li>
<li><strong>drpf</strong> (<a class="reference internal" href="mangadap.drpfits.html#mangadap.drpfits.DRPFits" title="mangadap.drpfits.DRPFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.drpfits.DRPFits</span></code></a>) – The DRP datacube with
the spectra to bin.</li>
<li><strong>rdxqa</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.proc.reductionassessments.ReductionAssessments</span></code>) – The basic assessments of the DRP data that are needed for
the binning procedures.</li>
<li><strong>reff</strong> (<em>float</em>) – (<strong>Optional</strong>) The effective radius of the galaxy.</li>
<li><strong>method_list</strong> (<em>list</em>) – (<strong>Optional</strong>) List of
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatiallyBinnedSpectraDef</span></code></a> objects that define one
or more methods to use for the spatial binning.  Default is
to use the config files in the DAP source directory to
construct the available methods using
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.available_spatial_binning_methods" title="mangadap.proc.spatiallybinnedspectra.available_spatial_binning_methods"><code class="xref py py-func docutils literal notranslate"><span class="pre">available_spatial_binning_methods()</span></code></a>.</li>
<li><strong>dapsrc</strong> (<em>str</em>) – (<strong>Optional</strong>) Root path to the DAP source
directory.  If not provided, the default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.dap_source_dir" title="mangadap.config.defaults.dap_source_dir"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.dap_source_dir()</span></code></a>.</li>
<li><strong>dapver</strong> (<em>str</em>) – (<strong>Optional</strong>) The DAP version to use for the
analysis, used to override the default defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_version" title="mangadap.config.defaults.default_dap_version"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_version()</span></code></a>.</li>
<li><strong>analysis_path</strong> (<em>str</em>) – (<strong>Optional</strong>) The top-level path for the
DAP output files, used to override the default defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_analysis_path" title="mangadap.config.defaults.default_analysis_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_analysis_path()</span></code></a>.</li>
<li><strong>directory_path</strong> (<em>str</em>) – The exact path to the directory with DAP
output that is common to number DAP “methods”.  See
<code class="xref py py-attr docutils literal notranslate"><span class="pre">directory_path</span></code>.</li>
<li><strong>output_file</strong> (<em>str</em>) – (<strong>Optional</strong>) Exact name for the output
file.  The default is to use
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_file_name" title="mangadap.config.defaults.default_dap_file_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_file_name()</span></code></a>.</li>
<li><strong>hardcopy</strong> (<em>bool</em>) – (<strong>Optional</strong>) Flag to write the HDUList
attribute to disk.  Default is True; if False, the HDUList
is only kept in memory and would have to be reconstructed.</li>
<li><strong>symlink_dir</strong> (<em>str</em>) – (<strong>Optional</strong>) Create a symbolic link to the
created file in the supplied directory.  Default is to
produce no symbolic link.</li>
<li><strong>clobber</strong> (<em>bool</em>) – (<strong>Optional</strong>) Overwrite any existing files.
Default is to use any existing file instead of redoing the
analysis and overwriting the existing output.</li>
<li><strong>checksum</strong> (<em>bool</em>) – (<strong>Optional</strong>) Use the checksum in the fits
header to confirm that the data has not been corrupted.  The
checksum is <strong>always</strong> written to the fits header when the
file is created; this argument does not toggle that
functionality.</li>
<li><strong>loggers</strong> (<em>list</em>) – (<strong>Optional</strong>) List of <a class="reference external" href="https://docs.python.org/3/library/logging.html">logging.Logger</a> objects
to log progress; ignored if quiet=True.  Logging is done
using <a class="reference internal" href="mangadap.util.log.html#mangadap.util.log.log_output" title="mangadap.util.log.log_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.log.log_output()</span></code></a>.  Default is no
logging.</li>
<li><strong>quiet</strong> (<em>bool</em>) – (<strong>Optional</strong>) Suppress all terminal and logging
output.  Default is False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.loggers">
<code class="descname">loggers</code><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.loggers" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – List of <a class="reference external" href="https://docs.python.org/3/library/logging.html">logging.Logger</a> objects to log
progress; ignored if quiet=True.  Logging is done using
<a class="reference internal" href="mangadap.util.log.html#mangadap.util.log.log_output" title="mangadap.util.log.log_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.log.log_output()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.quiet">
<code class="descname">quiet</code><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.quiet" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> – Suppress all terminal and logging output.</p>
</dd></dl>

<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Allow velocity offsets for registration.</li>
</ul>
</div>
<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._add_method_header">
<code class="descname">_add_method_header</code><span class="sig-paren">(</span><em>hdr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._add_method_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._add_method_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Add method-specific metadata to the header.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._add_reddening_header">
<code class="descname">_add_reddening_header</code><span class="sig-paren">(</span><em>hdr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._add_reddening_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._add_reddening_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the relevant reddening information to the header.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hdr</strong> (<em>astropy.io.fits.Header</em>) – Input header object to edit.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Edited header object.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">astropy.io.fits.Header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._apply_reddening">
<code class="descname">_apply_reddening</code><span class="sig-paren">(</span><em>flux</em>, <em>ivar</em>, <em>sdev</em>, <em>covar</em>, <em>deredden=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._apply_reddening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._apply_reddening" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._assign_image_arrays">
<code class="descname">_assign_image_arrays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._assign_image_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._assign_image_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="xref py py-attr docutils literal notranslate"><span class="pre">image_arrays</span></code>, which contains the list of extensions
in <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code> that are on-sky image data.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._assign_spectral_arrays">
<code class="descname">_assign_spectral_arrays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._assign_spectral_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._assign_spectral_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectral_arrays</span></code>, which contains the list of
extensions in <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code> that contain spectral data.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._binned_data_table">
<code class="descname">_binned_data_table</code><span class="sig-paren">(</span><em>bin_indx</em>, <em>stack_flux</em>, <em>stack_ivar</em>, <em>per_pixel=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._binned_data_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._binned_data_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the output data table for the binned spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bin_indx</strong> (<em>numpy.ndarray</em>) – The integer vector with the bin
associated with each spectrum in the DRP cube.  This is
the flattened BINID array.</li>
<li><strong>stack_flux</strong> (<em>numpy.ndarray</em>) – The stacked spectra, organized
as <span class="math notranslate nohighlight">\(N_{\rm spec}\times\N_\lambda}\)</span>.</li>
<li><strong>stack_flux</strong> – The stacked inverse variance,
organized as <span class="math notranslate nohighlight">\(N_{\rm spec}\times\N_\lambda}\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The record array that is put in the BINS
extension of <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.recarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._check_snr">
<code class="descname">_check_snr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._check_snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._check_snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine which spectra in <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdxqa</span></code> have a S/N greater than
the minimum set by <code class="xref py py-attr docutils literal notranslate"><span class="pre">method</span></code>.  Only these spectra will be
included in the binning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Boolean array for the spectra that satisfy
the criterion.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._construct_2d_hdu">
<code class="descname">_construct_2d_hdu</code><span class="sig-paren">(</span><em>bin_indx</em>, <em>good_fgoodpix</em>, <em>good_snr</em>, <em>bin_data</em>, <em>stack_flux</em>, <em>stack_sdev</em>, <em>stack_ivar</em>, <em>stack_npix</em>, <em>stack_mask</em>, <em>stack_sres</em>, <em>stack_covar</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._construct_2d_hdu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._construct_2d_hdu" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code> that is held in memory for manipulation of
the object.  See <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.construct_3d_hdu" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.construct_3d_hdu"><code class="xref py py-func docutils literal notranslate"><span class="pre">construct_3d_hdu()</span></code></a> if you want to convert
the object into a DRP-like datacube.</p>
<p>bin_indx is 2d</p>
<p>stack_sres is expected to be a MaskedArray</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._define_method">
<code class="descname">_define_method</code><span class="sig-paren">(</span><em>method_key</em>, <em>method_list=None</em>, <em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._define_method"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._define_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the method</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._fill_method_par">
<code class="descname">_fill_method_par</code><span class="sig-paren">(</span><em>good_spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._fill_method_par"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._fill_method_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Finalize the binning parameters, as needed.</p>
<p><strong>For the radial binning</strong>, set the ellipticity and position
angle.  Set scale radius to the effective radius if desired.</p>
<p><strong>For the Voronoi binning</strong>, set the signal and noise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>good_spec</strong> (<em>numpy.ndarray</em>) – List of spectra to include in
the binning.  See <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.check_fgoodpix" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.check_fgoodpix"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_fgoodpix()</span></code></a> and
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._check_snr" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._check_snr"><code class="xref py py-func docutils literal notranslate"><span class="pre">_check_snr()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._get_missing_bins">
<em class="property">static </em><code class="descname">_get_missing_bins</code><span class="sig-paren">(</span><em>unique_bins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._get_missing_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._get_missing_bins" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._initialize_cube_mask">
<code class="descname">_initialize_cube_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._initialize_cube_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._initialize_cube_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the mask, copying the DIDNOTUSE and FORESTAR bits
from the DRP file, and setting the LOW_SPECCOV and LOW_SNR bits
based on the input boolean arrays.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Bitmask array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._initialize_primary_header">
<code class="descname">_initialize_primary_header</code><span class="sig-paren">(</span><em>hdr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._initialize_primary_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._initialize_primary_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the header of <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Edited header object.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">astropy.io.fits.Header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._interpolated_response_function">
<code class="descname">_interpolated_response_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._interpolated_response_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._interpolated_response_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._per_bin_dtype">
<code class="descname">_per_bin_dtype</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._per_bin_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._per_bin_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the record array data type that holds the information
for the binned spectra.</p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<dl class="last docutils">
<dt>There currently is no mask; however, could add masks for:</dt>
<dd><ul class="first last simple">
<li>Insufficient good wavelength channels in the spectrum.</li>
<li>Variance in flux in bin is too large.</li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._set_paths">
<code class="descname">_set_paths</code><span class="sig-paren">(</span><em>directory_path</em>, <em>dapver</em>, <em>analysis_path</em>, <em>output_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._set_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._set_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the I/O path to the processed template library.  Used to set
<code class="xref py py-attr docutils literal notranslate"><span class="pre">directory_path</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">output_file</span></code>.  If not
provided, the defaults are set using, respectively,
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_common_path" title="mangadap.config.defaults.default_dap_common_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_common_path()</span></code></a> and
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_file_name" title="mangadap.config.defaults.default_dap_file_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_file_name()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>directory_path</strong> (<em>str</em>) – The exact path to the directory with
DAP output that is common to number DAP “methods”.  See
<code class="xref py py-attr docutils literal notranslate"><span class="pre">directory_path</span></code>.</li>
<li><strong>dapver</strong> (<em>str</em>) – DAP version.</li>
<li><strong>analysis_path</strong> (<em>str</em>) – The path to the top-level directory
containing the DAP output files for a given DRP and DAP
version.</li>
<li><strong>output_file</strong> (<em>str</em>) – The name of the file with the reduction assessments.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">compute()</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._unbinned_data_table">
<code class="descname">_unbinned_data_table</code><span class="sig-paren">(</span><em>bin_indx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra._unbinned_data_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra._unbinned_data_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the output data table for the unbinned spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bin_indx</strong> (<em>numpy.ndarray</em>) – The integer vector with the bin
associated with each spectrum in the DRP cube.  This is
the flattened BINID array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The record array that is put in the BINS
extension of <code class="xref py py-attr docutils literal notranslate"><span class="pre">hdu</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.recarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.above_snr_limit">
<code class="descname">above_snr_limit</code><span class="sig-paren">(</span><em>sn_limit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.above_snr_limit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.above_snr_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag bins above a provided S/N limit.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.bin_spectra">
<code class="descname">bin_spectra</code><span class="sig-paren">(</span><em>drpf</em>, <em>rdxqa</em>, <em>reff=None</em>, <em>dapver=None</em>, <em>analysis_path=None</em>, <em>directory_path=None</em>, <em>output_file=None</em>, <em>hardcopy=True</em>, <em>symlink_dir=None</em>, <em>clobber=False</em>, <em>loggers=None</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.bin_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.bin_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin and stack the spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>drpf</strong> (<a class="reference internal" href="mangadap.drpfits.html#mangadap.drpfits.DRPFits" title="mangadap.drpfits.DRPFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.drpfits.DRPFits</span></code></a>) – The DRP datacube
with the spectra to bin.</li>
<li><strong>rdxqa</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.proc.reductionassessments.ReductionAssessments</span></code>) – The basic assessments of the DRP data that are needed
for the binning procedures.</li>
<li><strong>reff</strong> (<em>float</em>) – (<strong>Optional</strong>) The effective radius of the
galaxy.</li>
<li><strong>dapver</strong> (<em>str</em>) – (<strong>Optional</strong>) The DAP version to use for the
analysis, used to override the default defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_version" title="mangadap.config.defaults.default_dap_version"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_version()</span></code></a>.</li>
<li><strong>analysis_path</strong> (<em>str</em>) – (<strong>Optional</strong>) The top-level path for
the DAP output files, used to override the default
defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_analysis_path" title="mangadap.config.defaults.default_analysis_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_analysis_path()</span></code></a>.</li>
<li><strong>directory_path</strong> (<em>str</em>) – The exact path to the directory with
DAP output that is common to number DAP “methods”.  See
<code class="xref py py-attr docutils literal notranslate"><span class="pre">directory_path</span></code>.</li>
<li><strong>output_file</strong> (<em>str</em>) – (<strong>Optional</strong>) Exact name for the output
file.  The default is to use
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.default_dap_file_name" title="mangadap.config.defaults.default_dap_file_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.default_dap_file_name()</span></code></a>.</li>
<li><strong>hardcopy</strong> (<em>bool</em>) – (<strong>Optional</strong>) Flag to write the HDUList
attribute to disk.  Default is True; if False, the
HDUList is only kept in memory and would have to be
reconstructed.</li>
<li><strong>symlink_dir</strong> (<em>str</em>) – (<strong>Optional</strong>) Create a symbolic link to
the created file in the supplied directory.  Default is
to produce no symbolic link.</li>
<li><strong>clobber</strong> (<em>bool</em>) – (<strong>Optional</strong>) Overwrite any existing files.
Default is to use any existing file instead of redoing
the analysis and overwriting the existing output.</li>
<li><strong>loggers</strong> (<em>list</em>) – (<strong>Optional</strong>) List of <a class="reference external" href="https://docs.python.org/3/library/logging.html">logging.Logger</a>
objects to log progress; ignored if quiet=True.  Logging
is done using <a class="reference internal" href="mangadap.util.log.html#mangadap.util.log.log_output" title="mangadap.util.log.log_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.log.log_output()</span></code></a>.
Default is no logging.</li>
<li><strong>quiet</strong> (<em>bool</em>) – (<strong>Optional</strong>) Suppress all terminal and
logging output.  Default is False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.check_fgoodpix">
<code class="descname">check_fgoodpix</code><span class="sig-paren">(</span><em>minimum_fraction=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.check_fgoodpix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.check_fgoodpix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine which spectra in <code class="xref py py-attr docutils literal notranslate"><span class="pre">rdxqa</span></code> have a fractional
spectral coverage of greater than the provided minimum fraction.
Only these spectra will be included in the binning.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>minimum_fraction</strong> (<em>float</em>) – (<strong>Optional</strong>) The minimum
fraction of the spectrum that must be valid for the
spectrum to be included in any bin.  Default is 0.8.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Boolean array for the spectra that satisfy
the criterion.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.construct_3d_hdu">
<code class="descname">construct_3d_hdu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.construct_3d_hdu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.construct_3d_hdu" title="Permalink to this definition">¶</a></dt>
<dd><p>Reformat the binned spectra into a cube matching the shape of
the DRP fits file from which it was derived.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_array">
<code class="descname">copy_to_array</code><span class="sig-paren">(</span><em>ext='FLUX'</em>, <em>waverange=None</em>, <em>include_missing=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.copy_to_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for <a class="reference internal" href="mangadap.util.fitsutil.html#mangadap.util.fitsutil.DAPFitsUtil.copy_to_array" title="mangadap.util.fitsutil.DAPFitsUtil.copy_to_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.fitsutil.DAPFitsUtil.copy_to_array()</span></code></a>
specific for <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatiallyBinnedSpectra</span></code></a>.</p>
<p>Return a copy of the selected data array.  The array size is
always <span class="math notranslate nohighlight">\(N_{\rm models} \times N_{\rm wavelength}\)</span>; i.e., the
data is always flattened to two dimensions and the unique
spectra are selected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ext</strong> (<em>str</em>) – (<strong>Optional</strong>) Name of the extension from which
to draw the data.  Must be allowed for the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code>; see <code class="xref py py-attr docutils literal notranslate"><span class="pre">data_arrays</span></code>.  Default is
<code class="docutils literal notranslate"><span class="pre">'FLUX'</span></code>.</li>
<li><strong>waverange</strong> (<em>array-like</em>) – (<strong>Optional</strong>) Two-element array
with the first and last wavelength to include in the
computation.  Default is to use the full wavelength
range.</li>
<li><strong>include_missing</strong> (<em>bool</em>) – (<strong>Optional</strong>) Create an array with
a size that accommodates the missing models.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A 2D array with a copy of the data from the
selected extension.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_masked_array">
<code class="descname">copy_to_masked_array</code><span class="sig-paren">(</span><em>ext='FLUX'</em>, <em>flag=None</em>, <em>waverange=None</em>, <em>include_missing=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.copy_to_masked_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_masked_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for
<a class="reference internal" href="mangadap.util.fitsutil.html#mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array" title="mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.fitsutil.DAPFitsUtil.copy_to_masked_array()</span></code></a>
specific for <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatiallyBinnedSpectra</span></code></a>.</p>
<p>Return a copy of the selected data array as a masked array.
This is functionally identical to <a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_array" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.copy_to_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_to_array()</span></code></a>,
except the output format is a <a class="reference external" href="http://docs.scipy.org/doc/numpy-1.10.1/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray">numpy.ma.MaskedArray</a>.  The
pixels that are considered to be masked can be specified using
<cite>flag</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ext</strong> (<em>str</em>) – (<strong>Optional</strong>) Name of the extension from which
to draw the data.  Must be allowed for the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code>; see <code class="xref py py-attr docutils literal notranslate"><span class="pre">data_arrays</span></code>.  Default is
<cite>‘FLUX’</cite>.</li>
<li><strong>flag</strong> (<em>str</em><em> or </em><em>list</em>) – (<strong>Optional</strong>) (List of) Flag names that
are considered when deciding if a pixel should be
masked.  The names <em>must</em> be a valid bit name as defined
by <code class="xref py py-attr docutils literal notranslate"><span class="pre">bitmask</span></code>.  If not provided, <em>ANY</em> non-zero
mask bit is omitted.</li>
<li><strong>waverange</strong> (<em>array-like</em>) – (<strong>Optional</strong>) Two-element array
with the first and last wavelength to include in the
computation.  Default is to use the full wavelength
range.</li>
<li><strong>include_missing</strong> (<em>bool</em>) – (<strong>Optional</strong>) Create an array with
a size that accommodates the missing models.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A 2D array with a copy of the data from the
selected extension.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.do_not_fit_flags">
<em class="property">static </em><code class="descname">do_not_fit_flags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.do_not_fit_flags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.do_not_fit_flags" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_name">
<code class="descname">file_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.file_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the name of the output file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_path">
<code class="descname">file_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.file_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full path to the output file.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.find_nearest_bin">
<code class="descname">find_nearest_bin</code><span class="sig-paren">(</span><em>input_bins</em>, <em>weighted=False</em>, <em>indices=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.find_nearest_bin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.find_nearest_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a KDTree to find the bins nearest to and excluding a list of
input bins.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_bins</strong> (<em>array-like</em>) – One or more bin ID numbers to use
to locate the bin nearest to it based on its on-sky
coordinates.  The list must be a unique set.</li>
<li><strong>weighted</strong> (<em>bool</em>) – (<strong>Optional</strong>) Use the weighted coordinates
(LW_SKY_COO) instead of the unweighted coordinates
(SKY_COO) when finding the nearest bin.</li>
<li><strong>indices</strong> (<em>bool</em>) – (<strong>Optional</strong>) Return the indices of the
nearest bins instead of their ID number (default).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The bin IDs, one per input bin, of the bin
closest to each input bin.  Any bins that are in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">missing_bins</span></code> have a return value of -1; there are no
coordinates for these bins.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy.ndarray</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the set of input bins is not unique or
contains bin IDs that are not present.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.get_bin_indices">
<code class="descname">get_bin_indices</code><span class="sig-paren">(</span><em>bins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.get_bin_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.get_bin_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the indices of the bins in the BIN table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bins</strong> (<em>array-like</em>) – The bin ID numbers to find</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Integer array with the index of each bin ID in
the BINID columns of the BINS extension.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.info">
<code class="descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.is_unbinned">
<code class="descname">is_unbinned</code><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.is_unbinned" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the spectra are unbinned.</p>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>ifile=None</em>, <em>strict=True</em>, <em>checksum=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an existing file with a previously binned set of spectra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ifile</strong> (<em>str</em>) – (<strong>Optional</strong>) Name of the file with the data.
Default is to use the name provided by
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_path" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.file_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">file_path()</span></code></a>.</li>
<li><strong>strict</strong> (<em>bool</em>) – (<strong>Optional</strong>) Force a strict reading of the
file to make sure that it adheres to the expected
format.  At the moment, this only checks to make sure
the method keyword printed in the header matches the
expected value in <code class="xref py py-attr docutils literal notranslate"><span class="pre">method</span></code>.</li>
<li><strong>checksum</strong> (<em>bool</em>) – (<strong>Optional</strong>) Use the checksum in the
header to check for corruption of the data.  Default is
False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileNotFoundError</span></code> – Raised if the file does not exist.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if strict is true and the header keyword
‘BINKEY’ does not match the method keyword.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.replace_with_data_from_nearest_bin">
<code class="descname">replace_with_data_from_nearest_bin</code><span class="sig-paren">(</span><em>data</em>, <em>bad_bins</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.replace_with_data_from_nearest_bin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.replace_with_data_from_nearest_bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace data in the list of provided bad bins with the data from
the nearest good bin.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array-like</em>) – Data for each bin.  The length must be
the same as <code class="xref py py-attr docutils literal notranslate"><span class="pre">nbins</span></code>.</li>
<li><strong>bad_bins</strong> (<em>array-like</em>) – The list of indices (must not be a
boolean array) with bad values to be replaced.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A new array with the bad data filled with the
data from the nearest bin.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy.ndarray</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if the input array doesn’t have the
correct shape or if the list of bad bins has numbers
outside the viable range (0,self.nbins-1).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.spectral_resolution_options">
<em class="property">static </em><code class="descname">spectral_resolution_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.spectral_resolution_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.spectral_resolution_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the allowed options for treating the spectral resolution.</p>
<p>Options are:</p>
<blockquote>
<div><p>‘spaxel’: If available, use the spectral resolution
determined for each spaxel.  This is pulled from the ‘DISP’
extension in the DRP file; an exception will be raised if
this extension does not exist!</p>
<p>‘cube’: Only consider the median spectral resolution
determine for the entire datacube.  This is pulled from the
‘SPECRES’ extension in the DRP file; an exception will be
raised if this extension does not exist!</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of the available method keywords.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>match_DRP=False</em>, <em>clobber=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectra.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the hdu object to the file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraBitMask">
<em class="property">class </em><code class="descclassname">mangadap.proc.spatiallybinnedspectra.</code><code class="descname">SpatiallyBinnedSpectraBitMask</code><span class="sig-paren">(</span><em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectraBitMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraBitMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a></p>
<p>Derived class that specifies the mask bits for the spatially binned
spectra.  See <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask" title="mangadap.util.bitmask.BitMask"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.bitmask.BitMask</span></code></a> for attributes.</p>
<p>A list of the bits and meanings are provided by the base class
function <a class="reference internal" href="mangadap.util.bitmask.html#mangadap.util.bitmask.BitMask.info" title="mangadap.util.bitmask.BitMask.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.util.bitmask.BitMask.info()</span></code></a>; i.e.,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mangadap.proc.spatiallybinnedspectra</span> <span class="k">import</span> <span class="n">SpatiallyBinnedSpectraBitMask</span>
<span class="n">bm</span> <span class="o">=</span> <span class="n">SpatiallyBinnedSpectraBitMask</span><span class="p">()</span>
<span class="n">bm</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef">
<em class="property">class </em><code class="descclassname">mangadap.proc.spatiallybinnedspectra.</code><code class="descname">SpatiallyBinnedSpectraDef</code><span class="sig-paren">(</span><em>key</em>, <em>galactic_reddening</em>, <em>galactic_rv</em>, <em>minimum_snr</em>, <em>binpar</em>, <em>binclass</em>, <em>binfunc</em>, <em>stackpar</em>, <em>stackclass</em>, <em>stackfunc</em>, <em>spec_res</em>, <em>prepixel_sres</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#SpatiallyBinnedSpectraDef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mangadap.par.parset.html#mangadap.par.parset.ParSet" title="mangadap.par.parset.ParSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.par.parset.ParSet</span></code></a></p>
<p>A class that holds the two parameter sets and the key designator for
the binning scheme.</p>
<p>binfunc must be able to function properly with the following call:</p>
<blockquote>
<div>id = bin(x, y, par=par)</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are the on-sky Cartesian coordiantes provided
by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">ReductionAssessment</span><span class="o">.</span><span class="n">hdu</span><span class="p">[</span><span class="s1">&#39;SPECTRUM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SKY_COO&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ReductionAssessment</span><span class="o">.</span><span class="n">hdu</span><span class="p">[</span><span class="s1">&#39;SPECTRUM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SKY_COO&#39;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>id is the index of the bin to place each spectrum.</p>
<p>stackfunc must be able to function properly with the following
call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stack_wave</span><span class="p">,</span> <span class="n">stack_flux</span><span class="p">,</span> <span class="n">stack_sdev</span><span class="p">,</span> <span class="n">stack_npix</span><span class="p">,</span> <span class="n">stack_ivar</span><span class="p">,</span>                 <span class="n">stack_sres</span><span class="p">,</span> <span class="n">stack_covar</span> <span class="o">=</span> <span class="n">stack</span><span class="p">(</span><span class="n">drpf</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">par</span><span class="o">=</span><span class="n">par</span><span class="p">)</span>
</pre></div>
</div>
<p>where <cite>drpf</cite> is a <a class="reference internal" href="mangadap.drpfits.html#mangadap.drpfits.DRPFits" title="mangadap.drpfits.DRPFits"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.drpfits.DRPFits</span></code></a> object.  Note
that the input and output wavelength ranges are expected to be the
same!  This is why the wavelengths are not returned!</p>
<p>As long as they are mutable, the values in par can change, meaning
that some products of the bin algorithm can be passed to the stack
algorithm.  For example, if you want to weight the inclusion of the
spectrum in the bin, you’d have to provide both the binning and
stacking routines.  Actually, if that’s the case, you’re better off
providing a class object that will both bin and stack the spectra!</p>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Impose a set of options of the form for the Galactic
reddening.</li>
</ul>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<em>str</em>) – Keyword used to distinguish between different spatial
binning schemes.</li>
<li><strong>binpar</strong> (<a class="reference internal" href="mangadap.par.parset.html#mangadap.par.parset.ParSet" title="mangadap.par.parset.ParSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.par.parset.ParSet</span></code></a> or dict) – The
parameter set defining how to place each spectrum in a bin.</li>
<li><strong>binclass</strong> (<em>object</em>) – Instance of class object to use for the
binning.  Needed in case binfunc is a non-static member
function of the class.</li>
<li><strong>binfunc</strong> (<em>callable</em>) – The function that determines which spectra
go into each bin.</li>
<li><strong>stackpar</strong> (<a class="reference internal" href="mangadap.par.parset.html#mangadap.par.parset.ParSet" title="mangadap.par.parset.ParSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.par.parset.ParSet</span></code></a> or dict) – The parameter
set defining how to stack the spectra in each bin.</li>
<li><strong>stackclass</strong> (<em>object</em>) – Instance of class object to used to stack
the spectra.  Needed in case stackfunc is a non-static
member function of the class.</li>
<li><strong>stackfunc</strong> (<em>callable</em>) – The function that stacks the spectra in a
given bin.</li>
<li><strong>spec_res</strong> (<em>str</em>) – Keyword defining the treatment of the spectral
resolution.  See
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.spectral_resolution_options" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectra.spectral_resolution_options"><code class="xref py py-func docutils literal notranslate"><span class="pre">SpatiallyBinnedSpectra.spectral_resolution_options()</span></code></a>
for a list of the options.</li>
<li><strong>prepixel_sres</strong> (<em>bool</em>) – Use the prepixelized version of the LSF
measurements.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mangadap.proc.spatiallybinnedspectra.available_spatial_binning_methods">
<code class="descclassname">mangadap.proc.spatiallybinnedspectra.</code><code class="descname">available_spatial_binning_methods</code><span class="sig-paren">(</span><em>dapsrc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#available_spatial_binning_methods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.available_spatial_binning_methods" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of available binning schemes.</p>
<p>The list of available binning schemes is defined by the set of
configuration files at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dapsrc</span><span class="p">,</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="s1">&#39;mangadap&#39;</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;spatial_binning&#39;</span><span class="p">)</span>
<span class="n">ini_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;/*.ini&#39;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dapsrc</strong> (<em>str</em>) – (<strong>Optional</strong>) Root path to the DAP source
directory.  If not provided, the default is defined by
<a class="reference internal" href="mangadap.config.defaults.html#mangadap.config.defaults.dap_source_dir" title="mangadap.config.defaults.dap_source_dir"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.config.defaults.dap_source_dir()</span></code></a>.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef"><code class="xref py py-func docutils literal notranslate"><span class="pre">mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef()</span></code></a>
objects, each defining a separate binning method.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">list</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotADirectoryError</span></code> – Raised if the provided or default
<em>dapsrc</em> is not a directory.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError/IOError</span></code> – Raised if no binning scheme configuration files
could be found.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code> – Raised if the binning method keywords are not all
unique.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Somehow add a python call that reads the databases and
constructs the table for presentation in sphinx so that the
text above doesn’t have to be edited with changes in the
available databases.</li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="mangadap.proc.spatiallybinnedspectra.validate_spatial_binning_scheme_config">
<code class="descclassname">mangadap.proc.spatiallybinnedspectra.</code><code class="descname">validate_spatial_binning_scheme_config</code><span class="sig-paren">(</span><em>cnfg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mangadap/proc/spatiallybinnedspectra.html#validate_spatial_binning_scheme_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mangadap.proc.spatiallybinnedspectra.validate_spatial_binning_scheme_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate the <a class="reference internal" href="mangadap.util.parser.html#mangadap.util.parser.DefaultConfig" title="mangadap.util.parser.DefaultConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.parser.DefaultConfig</span></code></a> object with
spatial-binning scheme parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cnfg</strong> (<a class="reference internal" href="mangadap.util.parser.html#mangadap.util.parser.DefaultConfig" title="mangadap.util.parser.DefaultConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.util.parser.DefaultConfig</span></code></a>) – Object with
the spatial-binning method parameters as needed by
<a class="reference internal" href="#mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef" title="mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef"><code class="xref py py-class docutils literal notranslate"><span class="pre">mangadap.proc.spatiallybinnedspectra.SpatiallyBinnedSpectraDef</span></code></a>.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code> – Raised if any required keywords do not exist.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – Raised if keys have unacceptable values.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">FileNotFoundError</span></code> – Raised if a file is specified but could not
be found.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mangadap.proc.spectralfitting.html" class="btn btn-neutral float-right" title="mangadap.proc.spectralfitting module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mangadap.proc.spatialbinning.html" class="btn btn-neutral" title="mangadap.proc.spatialbinning module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SDSS-IV/MaNGA Pipeline Group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>